package com.auto.interview.algorithm.leetcode;

import java.util.HashMap;
import java.util.Map;

/**
 * @author : jihai
 * @date : 2020/7/17
 * @description :
 *
 * 给定数组 nums 由正整数组成，找到三个互不重叠的子数组的最大和。
 *
 * 每个子数组的长度为k，我们要使这3*k个项的和最大化。
 *
 * 返回每个区间起始索引的列表（索引从 0 开始）。如果有多个结果，返回字典序最小的一个。
 *
 * 示例:
 *
 * 输入: [1,2,1,2,6,7,5,1], 2
 * 输出: [0, 3, 5]
 * 解释: 子数组 [1, 2], [2, 6], [7, 5] 对应的起始索引为 [0, 3, 5]。
 * 我们也可以取 [2, 1], 但是结果 [1, 3, 5] 在字典序上更大。
 * 注意:
 *
 * nums.length的范围在[1, 20000]之间。
 * nums[i]的范围在[1, 65535]之间。
 * k的范围在[1, floor(nums.length / 3)]之间。
 *
 * 来源：力扣（LeetCode）
 * 链接：https://leetcode-cn.com/problems/maximum-sum-of-3-non-overlapping-subarrays
 * 著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。
 */
public class MaxSubArray {


    //[7*,13,20,19*,19,2,10*,1,1,19]
    // 20 + 40 + 12 = 72
    //[7,13*,20,19,19*,2,10,1*,1,19]
    // 52 + 31 + 21 = 104
    public static void main(String[] args) {
        MaxSubArray maxSubArray = new MaxSubArray();
        long start = System.currentTimeMillis();
        int[] ints = maxSubArray.maxSumOfThreeSubarrays(new int[]{34862, 5978, 7231, 43282, 1088, 38968, 2104, 43141, 26103, 7684, 41947, 27896, 42975, 26731, 46408, 49767, 2724, 34541, 41014, 65379, 1795, 63681, 62644, 41145, 62831, 37164, 20705, 17349, 14266, 57371, 63209, 59756, 17300, 55624, 57035, 20420, 14508, 40841, 51601, 30689, 43469, 59949, 52354, 26600, 9394, 49713, 55690, 39588, 10063, 64349, 60226, 42479, 36173, 42870, 63491, 64687, 5765, 42132, 60102, 62290, 5184, 32394, 10450, 1118, 22754, 62543, 49368, 59795, 4790, 57591, 28932, 15480, 65286, 16295, 38709, 28527, 49676, 16514, 58401, 49095, 33604, 19888, 58348, 60270, 1148, 61000, 34069, 40111, 18541, 43715, 32549, 60436, 12544, 35880, 9895, 48524, 26303, 8058, 64783, 43067, 50283, 51130, 8074, 39645, 55723, 37352, 7622, 38239, 1089, 21200, 7051, 53125, 17900, 23675, 31122, 14026, 10053, 347, 1253, 44409, 44759, 40481, 22424, 48511, 1497, 19020, 46429, 9975, 34280, 31565, 44859, 21247, 25997, 19740, 42040, 49416, 37307, 32604, 3231, 31428, 1260, 59657, 23988, 13059, 18033, 59701, 956, 11198, 25228, 40179, 39997, 731, 52703, 8515, 19727, 54430, 59837, 16421, 3394, 52706, 22351, 44820, 9800, 61396, 29309, 7524, 37776, 43301, 17670, 55498, 28744, 60275, 10489, 6297, 50323, 47286, 15343, 20258, 44718, 57395, 28404, 6317, 58247, 47295, 8948, 17663, 38383, 51008, 63981, 44027, 3308, 41957, 5096, 43724, 14414, 54964, 46694, 16096, 2041, 5316, 48236, 16640, 8381, 55962, 9078, 47423, 44564, 62765, 17166, 18032, 22870, 43143, 57442, 47810, 20061, 10328, 38353, 58863, 22442, 12787, 36509, 1825, 26045, 61431, 6468, 31377, 34216, 18140, 15277, 54629, 14299, 53051, 5802, 54314, 39052, 60488, 5298, 20738, 4885, 13425, 47392, 59456, 58233, 32822, 2151, 36644, 48321, 64642, 34695, 26627, 39669, 28387, 14618, 46413, 29672, 1198, 32667, 59914, 23707, 35048, 58593, 18524, 44850, 45737, 15570, 44897, 33792, 1140, 23703, 29913, 16587, 54371, 41417, 39092, 48572, 5372, 27287, 42785, 57925, 276, 36069, 53787, 10804, 4445, 21568, 15838, 64071, 47726, 44422, 41549, 7872, 61652, 9514, 64446, 59265, 14668, 4382, 30167, 25165, 23346, 10103, 63586, 17793, 12593, 25932, 62244, 8625, 30191, 47534, 37605, 18441, 18764, 23220, 20679, 35502, 50108, 48655, 64972, 17937, 23106, 42183, 48918, 53480, 52930, 43699, 3881, 23953, 6492, 39620, 3370, 27792, 27855, 52927, 39271, 10462, 42071, 20780, 708, 16270, 59837, 29592, 9301, 28152, 26796, 10064, 3362, 62618, 11222, 24346, 2771, 22326, 8141, 25987, 62768, 23846, 45454, 56481, 3129, 22090, 56742, 746, 24273, 30021, 17252, 63039, 14163, 24948, 5184, 32119, 21730, 4621, 25724, 14179, 5462, 5043, 65112, 47524, 21983, 7491, 29534, 8352, 14952, 8139, 55663, 4585, 4683, 16462, 39879, 57807, 62544, 63140, 45841, 7456, 57412, 6256, 21736, 48288, 60459, 12285, 456, 27830, 58488, 12768, 22264, 33873, 40394, 8042, 8714, 47942, 61076, 59100, 48989, 33021, 15074, 45342, 31846, 35483, 14533, 50169, 3285, 1668, 32346, 61503, 22745, 22161, 3612, 55768, 58575, 41529, 15342, 14322, 42357, 57224, 60197, 40693, 54222, 56128, 40490, 48914, 17817, 38060, 8119, 40363, 10355, 13055, 60935, 20354, 45993, 11931, 47117, 11374, 57046, 12522, 974, 63883, 23379, 16418, 37539, 21929, 52878, 20893, 6905, 16829, 14425, 36637, 23061, 59485, 57525, 34849, 62077, 45392, 36603, 3568, 52287, 55327, 38903, 23660, 47670, 40141, 26731, 15240, 56965, 5544, 47084, 50332, 35788, 4389, 11887, 47755, 51724, 19804, 41579, 24188, 12236, 17416, 37115, 15519, 36337, 52678, 44792, 32088, 9533, 7391, 58545, 38786, 48396, 10209, 32655, 3232, 61120, 48633, 45348, 60576, 61974, 969, 6606, 63586, 18752, 56684, 35735, 63380, 65290, 13634, 63572, 5901, 53933, 23772, 51764, 3025, 44304, 60758, 2152, 7774, 529, 49218, 65509, 21130, 63440, 49631, 12106, 6022, 30861, 1759, 63724, 62086, 7272, 23604, 21124, 55000, 46040, 63949, 46596, 50251, 37935, 47414, 12515, 25070, 36189, 54209, 16718, 16986, 35061, 56238, 48819, 19463, 55455, 57544, 39003, 18680, 43178, 7099, 30642, 51743, 7737, 1899, 55442, 46652, 8467, 18950, 34306, 16758, 26461, 43949, 45668, 59716, 45621, 33234, 22778, 9287, 44408, 44295, 10760, 50051, 49666, 62104, 4786, 5220, 870, 57131, 2146, 1103, 25365, 12812, 30958, 20032, 57225, 35897, 56973, 53270, 49373, 50643, 49450, 13882, 46211, 31498, 30879, 34983, 41101, 38360, 27459, 30469, 15293, 48, 12878, 27745, 25548, 4726, 47441, 23011, 5854, 61479, 26351, 48744, 29828, 63854, 12327, 1689, 23101, 7836, 10044, 16110, 30440, 38607, 11027, 42090, 60859, 39846, 2089, 35703, 49025, 42478, 14706, 41077, 41435, 36520, 55129, 3427, 52680, 3559, 50470, 39726, 4772, 39116, 5011, 17229, 64796, 51961, 10864, 39928, 27618, 3482, 8773, 49767, 18995, 24328, 4261, 11520, 32467, 25172, 9505, 37339, 5223, 36198, 49677, 43944, 9176, 23981, 33362, 16008, 14856, 49555, 44699, 35018, 15395, 36510, 43098, 15326, 7033, 36488, 17207, 21545, 38201, 51181, 30950, 10549, 35825, 16974, 55879, 63075, 46153, 1003, 14468, 3897, 54840, 32220, 12781, 63821, 45680, 65067, 29238, 60257, 27201, 55081, 36057, 31320, 39075, 38082, 675, 19144, 25960, 40036, 36857, 33936, 39131, 50803, 21871, 30009, 26328, 9272, 29388, 25662, 39763, 28635, 59297, 53065, 17111, 20953, 49180, 55749, 37276, 27627, 15536, 59070, 14208, 61076, 37655, 43251, 58869, 5656, 12673, 63551, 32931, 30089, 27766, 60240, 18692, 49580, 30739, 12057, 48584, 58569, 27693, 44448, 54755, 1377, 10952, 35484, 46004, 43190, 47371, 38094, 41251, 30152, 25704, 60388, 25301, 36801, 56534, 29257, 6497, 38161, 20226, 62094, 9850, 3201, 64170, 39626, 484, 49117, 42609, 23198, 26142, 46043, 49487, 52870, 29061, 62649, 58112, 42739, 47141, 25605, 18347, 59307, 62808, 4664, 44274, 53911, 10877, 31334, 1920, 25813, 47334, 27146, 45657, 27125, 54955, 43912, 58391, 35091, 24099, 58534, 43678, 38800, 18181, 28181, 40084, 61737, 34045, 15438, 179, 54715, 24042, 38006, 42105, 29135, 52921, 28479, 2018, 41815, 64760, 44603, 3967, 18749, 60982, 40179, 11277, 34746, 23089, 27976, 48970, 110, 19339, 45108, 50091, 34773, 55372, 6129, 56481, 56690, 30302, 34460, 54852, 47144, 18011, 20865, 2058, 51762, 64236, 55018, 56956, 63832, 13823, 43874, 45185, 27401, 33665, 251, 2197, 51069, 20167, 30579, 18184, 25949, 60913, 62833, 41586, 59103, 12403, 52829, 30827, 33881, 57085, 63142, 23665, 58822, 57183, 9959, 24171, 3047, 46735, 13783, 58440, 41774, 25054, 57298, 48240, 41803, 47824, 18321, 59872, 58887, 51162, 61987, 65096, 12817, 44134, 18403, 17503, 32500, 48322, 15379, 22690, 10488, 42883, 51621, 3549, 28685, 36446, 48557, 58966, 448, 62116, 45645, 22548, 8290, 10195, 5436, 29445, 39596, 24084, 26216, 20611, 51360, 30551, 56227, 44448, 2074, 19131, 30891, 53777, 41290, 18145, 3747, 29765, 51806, 54319, 1906, 6229, 59666, 19879, 62416, 37727, 13947, 11501, 16571, 55183, 40415, 3842, 7715, 33874, 24558, 55276, 42038, 25551, 44715, 234, 7964, 51625, 30610, 64678, 16370, 14263, 14037, 56853, 14075, 51302, 40879, 51485, 20444, 2649},
                38);
        long end = System.currentTimeMillis();
        System.out.println("cost : " + (end - start) + "ms");
    }

    /**
     * search the max value sub array
     * 0. consider the special case
     * 1. find the the max three sub array
     * 2. get the index of the array
     */
    public int[] maxSumOfThreeSubarrays(int[] nums, int k) {
        if (nums.length < k) {
            // error
            return null;
        }
        if (nums.length == k) {
            return new int[]{0, 0, 0};
        }

        // find the max value
        return searchTheMaxArray(nums, k);
    }

    /**
     * set array as a windows slide
     *
     * [1, 2, 3, 4, 5, 6... k] ....[n, n + 1 ....] ... [x, x + 1, ....]
     * <--------- k -------->     </---- k -----> ...
     *
     * @param nums
     * @param k
     * @return
     */
    private int[] searchTheMaxArray(int[] nums, int k) {
        int maxValue = nums[0];
        int[] result = null;
        for (int i = 2 * k; i <= nums.length - k; i++) {
            for (int j = k; j <= i - k; j++) {
                for (int l = 0; l <= j - k; l++) {
                    int val = sumSubArrayValue(nums, l, j, i, k);
                    if (val > maxValue) {
                        maxValue = val;
                        result = new int[]{l, j, i};
                    }
                }
            }
        }
        return result;
    }

    private int sumSubArrayValue(int[] nums, int first, int second, int third, int k) {
        return getValueByIndex(nums, first, k) + getValueByIndex(nums, second, k) + getValueByIndex(nums, third, k);
    }

    private int getValueByIndex(int[] nums, int index, int k) {
        // first version
        int sum = 0;
        for (int i = 0; i < k; i++) {
            sum += nums[index ++];
        }
        return sum;
    }

}
